
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .sidebar-container {
        position: fixed;
        width: 220px;
        height: 100%;
        left: 0;
        overflow-x: hidden;
        overflow-y: auto;
        background: #1a1a1a;
        color: #fff;
    }

    .content-container {
        padding-top: 20px;
    }

    .sidebar-logo {
        padding: 10px 15px 10px 30px;
        font-size: 20px;
        background-color: #2574A9;
    }

    .sidebar-navigation {
        padding: 0;
        margin: 0;
        list-style-type: none;
        position: relative;
    }

        .sidebar-navigation li {
            background-color: transparent;
            position: relative;
            display: inline-block;
            width: 100%;
            line-height: 20px;
        }

            .sidebar-navigation li a {
                padding: 10px 15px 10px 30px;
                display: block;
                color: #fff;
            }

            .sidebar-navigation li .fa {
                margin-right: 10px;
            }

            .sidebar-navigation li a:active,
            .sidebar-navigation li a:hover,
            .sidebar-navigation li a:focus {
                text-decoration: none;
                outline: none;
            }

            .sidebar-navigation li::before {
                background-color: #2574A9;
                position: absolute;
                content: '';
                height: 100%;
                left: 0;
                top: 0;
                -webkit-transition: width 0.2s ease-in;
                transition: width 0.2s ease-in;
                width: 3px;
                z-index: -1;
            }

            .sidebar-navigation li:hover::before {
                width: 100%;
            }

        .sidebar-navigation .header {
            font-size: 12px;
            text-transform: uppercase;
            background-color: #151515;
            padding: 10px 15px 10px 30px;
        }

            .sidebar-navigation .header::before {
                background-color: transparent;
            }

    .content-container {
        padding-left: 220px;
    }
</style>


<div class="sidebar-container">
    <div class="sidebar-logo">
        Moshira Admin Panel
    </div>
    <ul class="sidebar-navigation">
        <li class="header">İşlemler</li>
        <li>
            <a href="~/Admin/Index">
                <i class="fas fa-book-reader"></i>Rezervasyon Defteri
            </a>
        </li>

        <li class="header">Yönetici Panel İşlemleri</li>
        <li>
            <a href="~/Identity/Account/Register">
                <i class="fa fa-users" aria-hidden="true"></i> Yönetici Ekle
            </a>
        </li>

    </ul>
</div>
<div class="content-container">
    <ul class="nav nav-tabs nav-bordered mb-3 customtab" id="sekmeler">
        <li class="nav-item">
            <a id="itema1" href="#itemsa1" data-toggle="tab" aria-expanded="false" class="nav-link active">
                <i class="fas fa-grip-horizontal d-lg-none d-block mr-1"></i>
                <span class="d-none d-lg-block">Aktif Randevular</span>

            </a>
        </li>
        <li class="nav-item">
            <a id="itema2" href="#itemsa2" data-toggle="tab" aria-expanded="false" class="nav-link">
                <i class="fas fa-grip-horizontal d-lg-none d-block mr-1"></i>
                <span class="d-none d-lg-block">Bitmiş Randevular</span>
            </a>
        </li>

        <li class="nav-item">
            <a id="itema3" href="#itemsa3" data-toggle="tab" aria-expanded="false" class="nav-link">
                <i class="fas fa-grip-horizontal d-lg-none d-block mr-1"></i>
                <span class="d-none d-lg-block" id="IcmalTabCont">İptal Olan Randevular</span>
            </a>
        </li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="itemsa1">
            <div class="container-fluid">
                <div class="container-fluid">
                    <table id="example" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>

                        <tfoot>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                                <th>İşlemler</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-pane" id="itemsa2">
            <div class="container-fluid">
                <div class="container-fluid">
                    <table id="example2" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-pane" id="itemsa3">
            <div class="container-fluid">
                <div class="container-fluid">
                    <table id="example3" class="display" style="width:100%">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th></th>
                                <th>Ad</th>
                                <th>Soyad</th>
                                <th>Email</th>
                                <th>Oda Numarası</th>
                                <th>Oda Türü</th>
                                <th>Çocuk Sahibi Mi</th>
                                <th>R.Başlama Tarihi</th>
                                <th>R.Bitiş Tarihi</th>
                                <th>Notlar</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>



</div>
@section Scripts{
    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.3.1/jszip-2.5.0/dt-1.10.24/af-2.3.6/b-1.7.0/b-colvis-1.7.0/b-html5-1.7.0/b-print-1.7.0/cr-1.5.3/date-1.0.3/fc-3.3.2/fh-3.1.8/kt-2.6.1/r-2.2.7/rg-1.1.2/rr-1.2.7/sc-2.0.3/sb-1.0.1/sp-1.2.2/sl-1.3.3/datatables.min.js"></script>
    <script>
        var strIconSearch = '<i class="fas fa-search"></i>';
        $.extend(true, $.fn.dataTable.defaults, {
            "oLanguage": {
                "sDecimal": ",",
                "sEmptyTable": "Tabloda herhangi bir veri mevcut değil",
                "sInfo": "_TOTAL_ kayıttan _START_ - _END_ arasındaki kayıtlar gösteriliyor",
                "sInfoEmpty": "Kayıt yok",
                "sInfoFiltered": "(_MAX_ kayıt içerisinden bulunan)",
                "sInfoPostFix": "",
                "sInfoThousands": ".",
                "sLengthMenu": "Sayfada _MENU_ kayıt göster",
                "sLoadingRecords": "Yükleniyor...",
                "sProcessing": "İşleniyor...",
                "sSearch": "Ara:",
                "sZeroRecords": "Eşleşen kayıt bulunamadı",
                "oPaginate": {
                    "sFirst": "İlk",
                    "sLast": "Son",
                    "sNext": "Sonraki",
                    "sPrevious": "Önceki",
                },
                "oAria": {
                    "sSortAscending": ": artan sütun sıralamasını aktifleştir",
                    "sSortDescending": ": azalan sütun sıralamasını aktifleştir"
                },
                "select": {
                    "rows": {
                        "_": "%d kayıt seçildi",
                        "0": "",
                        "1": "1 kayıt seçildi"
                    }
                }
            }
        }
        );
        $.fn.dataTable.Buttons.defaults.dom.button.className = 'btn btn-grid';
        $.extend($.fn.dataTable.defaults, {
            language: {
                "processing": "Yükleniyor..."
            },
        });
                var table2 = $('#example2').DataTable({
                    "ajax": {
                        "url": "/Admin/CustomerlaBitmisler",
                        "data": {
                            t: ""
                        },
                        "type": "POST",
                        "datatype": "json"
                    },
                    'columnDefs': [{
                        targets: "_all",
                        className: ""
                    },],
                    "columns": [
                        {
                            'className': 'dtr-control',
                            'orderable': false,
                            'data': null,
                            'defaultContent': ''
                        },
                        {
                            "data": "ad",
                            "name": "ad",
                            "autoWidth": true
                        },
                        {
                            "data": "soyad",
                            "name": "soyad",
                            "autoWidth": true
                        },
                        {
                            "data": "email",
                            "name": "email",
                            "autoWidth": true
                        },
                        {
                            "data": "odanumarasi",
                            "name": "odanumarasi",
                            "autoWidth": true
                        },
                        {
                            "data": "odaturu",
                            "name": "odaturu",
                            "autoWidth": true
                        },
                        {
                            "data": "cocukvarmi",
                            "name": "cocukvarmi",
                            "autoWidth": true, "render": function (data) {
                                if (data = true) {
                                    return '<strong style="color:green"><ins> ' + "Evet" + '!</ins> </strong>'
                                } else {
                                    return '<strong style="color:red"> <ins> ' + "Hayır" + '! </ins> </strong>'
                                }
                            }
                        },
                        {
                            "data": "r_baslama",
                            "name": "r_baslama",
                            "autoWidth": true, "render": function (data) {
                                return data ? data.split("T")[0] : data;
                            }
                        },
                        {
                            "data": "r_bitis",
                            "name": "r_bitis",
                            "autoWidth": true, "render": function (data) {
                                return data ? data.split("T")[0] : data;
                            }
                        },
                        {
                            "data": "notlar",
                            "name": "notlar",
                            "autoWidth": true
                        }
                    ]
                });
                var table3 = $('#example3').DataTable({
                    "ajax": {
                        "url": "/Admin/CustomerlaIptal",
                        "data": {
                            t: ""
                        },
                        "type": "POST",
                        "datatype": "json"
                    },
                    'columnDefs': [{
                        targets: "_all",
                        className: ""
                    },],
                    "columns": [
                        {
                            'className': 'dtr-control',
                            'orderable': false,
                            'data': null,
                            'defaultContent': ''
                        },
                        {
                            "data": "ad",
                            "name": "ad",
                            "autoWidth": true
                        },
                        {
                            "data": "soyad",
                            "name": "soyad",
                            "autoWidth": true
                        },
                        {
                            "data": "email",
                            "name": "email",
                            "autoWidth": true
                        },
                        {
                            "data": "odanumarasi",
                            "name": "odanumarasi",
                            "autoWidth": true
                        },
                        {
                            "data": "odaturu",
                            "name": "odaturu",
                            "autoWidth": true
                        },
                        {
                            "data": "cocukvarmi",
                            "name": "cocukvarmi",
                            "autoWidth": true, "render": function (data) {
                                if (data = true) {
                                    return '<strong style="color:green"><ins> ' + "Evet" + '!</ins> </strong>'
                                } else {
                                    return '<strong style="color:red"> <ins> ' + "Hayır" + '! </ins> </strong>'
                                }
                            }
                        },
                        {
                            "data": "r_baslama",
                            "name": "r_baslama",
                            "autoWidth": true, "render": function (data) {
                                return data ? data.split("T")[0] : data;
                            }
                        },
                        {
                            "data": "r_bitis",
                            "name": "r_bitis",
                            "autoWidth": true, "render": function (data) {
                                return data ? data.split("T")[0] : data;
                            }
                        },
                        {
                            "data": "notlar",
                            "name": "notlar",
                            "autoWidth": true
                        }

                    ]
                });
        var table =  $('#example').DataTable({
            "ajax": {
                "url": "/Admin/Customerla",
                "data": {
                    t:""
                },
                "type": "POST",
                "datatype": "json"
            },
            'columnDefs': [{
                targets: "_all",
                className: ""
            },],
            "columns": [
                {
                    'className': 'dtr-control',
                    'orderable': false,
                    'data': null,
                    'defaultContent': ''
                },
                {
                    "data": "ad",
                    "name": "ad",
                    "autoWidth": true
                },
                {
                    "data": "soyad",
                    "name": "soyad",
                    "autoWidth": true
                },
                {
                    "data": "email",
                    "name": "email",
                    "autoWidth": true
                },
                {
                    "data": "odanumarasi",
                    "name": "odanumarasi",
                    "autoWidth": true
                },
                {
                    "data": "odaturu",
                    "name": "odaturu",
                    "autoWidth": true
                },
                {
                    "data": "cocukvarmi",
                    "name": "cocukvarmi",
                    "autoWidth": true, "render": function (data) {
                        if (data = true) {
                            return '<strong style="color:green"><ins> ' + "Evet"+ '!</ins> </strong>'
                        } else {
                            return '<strong style="color:red"> <ins> ' + "Hayır"+ '! </ins> </strong>'
                        }
                    }
                },
                {
                    "data": "r_baslama",
                    "name": "r_baslama",
                    "autoWidth": true, "render": function (data) {
                        return data ? data.split("T")[0] : data;
                    }
                },
                {
                    "data": "r_bitis",
                    "name": "r_bitis",
                    "autoWidth": true, "render": function (data) {
                        return data ? data.split("T")[0] : data;
                    }
                },
                {
                    "data": "notlar",
                    "name": "notlar",
                    "autoWidth": true
                },
                {
                    "data": null,
                    "name": null,
                    "autoWidth": true,
                    "render": function (data, type, row) {
                        return '<button class="btn btn-warning k-chip-hover" data-id=' + row.id + '  id="rezervasyonIptal">Rezervasyon İptal</button>' + '<button class="btn btn-primary k-chip-hover" id="rezervationDone" data-id=' + row.id +'>Rezervasyon Bitti</button>';  }
                }
                ]
        });
        $('#example').on('click', '#rezervationDone', function () {
            var id = $(this).attr("data-id");
        $.ajax({
            type: "POST",
            url: '@Url.Action("RezervasyonBitti", "Admin")',
            data: {
                id: id
            },
            dataType: "Json",
            success: function (data) {
                Swal.fire({
                    icon: 'success',
                    title: 'Randevu Bitirildi',
                    text: 'OK!'

                })
                table.ajax.reload();
                table2.ajax.reload();
                table3.ajax.reload();
            }
        });
        });
        $('#example').on('click', '#rezervasyonIptal', function () {
            var id = $(this).attr("data-id");
        $.ajax({
            type: "POST",
            url: '@Url.Action("RezervasyonIptal", "Admin")',
            data: {
                id: id
            },
            dataType: "Json",

            success: function (data) {
                Swal.fire({
                    icon: 'success',
                    title: 'Randevu İptal Edildi',
                    text: 'OK!'
                })
                table.ajax.reload();
                table2.ajax.reload();
                table3.ajax.reload();
            }
        });
        });
    </script>
}
